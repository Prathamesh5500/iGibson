<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Scenes &mdash; iGibson 2.2.2 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Objects" href="objects.html" />
    <link rel="prev" title="Environments" href="environments.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> iGibson
          </a>
              <div class="version">
                2.2.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">iGibson: the Interactive Gibson Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview of Modules</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="assets.html">Assets</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulators.html">Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="extended_states.html">Extended States and Logic States</a></li>
<li class="toctree-l1"><a class="reference internal" href="renderer.html">Renderer</a></li>
<li class="toctree-l1"><a class="reference internal" href="viewer.html">Viewer</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.html">Environments</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Scenes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-other-scenes-to-igibson">Adding other scenes to iGibson</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#stadium-scenes">Stadium Scenes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#static-building-scenes">Static Building Scenes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interactive-building-scenes">Interactive Building Scenes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#texture-randomization">Texture Randomization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#object-randomization">Object Randomization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#partial-scene-loading">Partial Scene Loading</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#visualize-traversability-map">Visualize Traversability Map</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="objects.html">Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="robots.html">Robots</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">Sampling Scene Instances</a></li>
<li class="toctree-l1"><a class="reference internal" href="learning_framework.html">Learning Frameworks</a></li>
<li class="toctree-l1"><a class="reference internal" href="ros_integration.html">ROS Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">Tests and Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Code Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="apidoc/modules.html">igibson</a></li>
</ul>
<p class="caption"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="issues.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="projects.html">Projects using Gibson/iGibson</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgments</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">iGibson</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Scenes</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/scenes.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="scenes">
<h1>Scenes<a class="headerlink" href="#scenes" title="Permalink to this headline"></a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p>We provide four types of scenes.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">EmptyScene</span></code> and <code class="docutils literal notranslate"><span class="pre">StadiumScene</span></code>: they are simple scenes with flat grounds and no obstacles, useful for debugging purposes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">StaticIndoorScene</span></code>: it loads static 3D scenes from <code class="docutils literal notranslate"><span class="pre">igibson.g_dataset_path</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">InteractiveIndoorScene</span></code>: it loads fully interactive 3D scenes from <code class="docutils literal notranslate"><span class="pre">igibson.ig_dataset_path</span></code>.</p></li>
</ul>
<p>Typically, they take in the <code class="docutils literal notranslate"><span class="pre">scene_id</span></code> of a scene and provide a <code class="docutils literal notranslate"><span class="pre">load</span></code> function that be invoked externally (usually by <code class="docutils literal notranslate"><span class="pre">import_scene</span></code> of the <code class="docutils literal notranslate"><span class="pre">Simulator</span></code>).</p>
<p>To be more specific, the <code class="docutils literal notranslate"><span class="pre">load</span></code> function of <code class="docutils literal notranslate"><span class="pre">StaticIndoorScene</span></code></p>
<ul class="simple">
<li><p>stores the floor information (we have many multistory houses in our dataset)</p></li>
<li><p>loads the scene mesh into PyBullet</p></li>
<li><p>builds an internal traversability graph for each floor based on the traversability maps stored in the scene folder (e.g. <code class="docutils literal notranslate"><span class="pre">dataset/Rs/floor_trav_0.png</span></code>)</p></li>
<li><p>provides APIs for sampling a random location in the scene, and for computing the shortest path between two locations in the scene.</p></li>
</ul>
<p>In addition to everything mentioned above, the <code class="docutils literal notranslate"><span class="pre">load</span></code> function of <code class="docutils literal notranslate"><span class="pre">InteractiveIndoorScene</span></code> also</p>
<ul class="simple">
<li><p>provides material/texture randomization functionality: randomize the material, texture and dynamic property of scene object models</p></li>
<li><p>provides object randomization functionality: randomize scene object models while keeping object poses and categories intact</p></li>
<li><p>provides scene quality check: check if object models have collisions and if fixed, articulated objects can extend their joints fully without collision</p></li>
<li><p>provides partial scene loading functionality: 1) only load objects of certain categories, 2) only load objects in certain room types, 3) only load objects in certain room instances.</p></li>
<li><p>provides APIs for changing the state of articulated objects (e.g. open all “fridges” and “ovens” in the scene)</p></li>
</ul>
<p>Most of the code can be found here: <a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/scenes">igibson/scenes</a>.</p>
</div>
<div class="section" id="adding-other-scenes-to-igibson">
<h2>Adding other scenes to iGibson<a class="headerlink" href="#adding-other-scenes-to-igibson" title="Permalink to this headline"></a></h2>
<p>We provide detailed instructions and scripts to import scenes from the following sources into iGibson:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://github.com/CubiCasa/CubiCasa5k">CubiCasa5k</a>: A Dataset and an Improved Multi-Task Model for Floorplan Image Analysis. (Kalervo, Ahti, et al.)</p></li>
<li><p><a class="reference external" href="https://tianchi.aliyun.com/specials/promotion/alibaba-3d-scene-dataset">3D-FRONT</a>: 3D Furnished Rooms with layOuts and semaNTics. (Fu, Huanl, et al.)</p></li>
</ol>
<p>Instruction can be found here: <a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/utils/data_utils/ext_scene">External Scenes</a>.</p>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline"></a></h2>
<div class="section" id="stadium-scenes">
<h3>Stadium Scenes<a class="headerlink" href="#stadium-scenes" title="Permalink to this headline"></a></h3>
<p>In this example, we import a simple stadium scene that is good for debugging. The code can be found here: <a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/scenes/stadium_example.py">igibson/examples/scenes/stadium_example.py</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">igibson.render.mesh_renderer.mesh_renderer_settings</span> <span class="kn">import</span> <span class="n">MeshRendererSettings</span>
<span class="kn">from</span> <span class="nn">igibson.render.profiler</span> <span class="kn">import</span> <span class="n">Profiler</span>
<span class="kn">from</span> <span class="nn">igibson.scenes.stadium_scene</span> <span class="kn">import</span> <span class="n">StadiumScene</span>
<span class="kn">from</span> <span class="nn">igibson.simulator</span> <span class="kn">import</span> <span class="n">Simulator</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">selection</span><span class="o">=</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="n">headless</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">short_exec</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads the Stadium scene</span>
<span class="sd">    This scene is default in pybullet but is not really useful in iGibson</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Description:&quot;</span> <span class="o">+</span> <span class="n">main</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">+</span> <span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>

    <span class="n">settings</span> <span class="o">=</span> <span class="n">MeshRendererSettings</span><span class="p">(</span><span class="n">enable_shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">msaa</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;gui_interactive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">headless</span> <span class="k">else</span> <span class="s2">&quot;headless&quot;</span><span class="p">,</span>
        <span class="n">image_width</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
        <span class="n">image_height</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
        <span class="n">rendering_settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">scene</span> <span class="o">=</span> <span class="n">StadiumScene</span><span class="p">()</span>
    <span class="n">s</span><span class="o">.</span><span class="n">import_scene</span><span class="p">(</span><span class="n">scene</span><span class="p">)</span>

    <span class="n">max_steps</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">short_exec</span> <span class="k">else</span> <span class="mi">1000</span>
    <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">step</span> <span class="o">!=</span> <span class="n">max_steps</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">Profiler</span><span class="p">(</span><span class="s2">&quot;Simulator step&quot;</span><span class="p">):</span>
            <span class="n">s</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="n">step</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">s</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>The stadium scene looks like this:
<img alt="scene_stadium" src="_images/scene_stadium.png" /></p>
</div>
<div class="section" id="static-building-scenes">
<h3>Static Building Scenes<a class="headerlink" href="#static-building-scenes" title="Permalink to this headline"></a></h3>
<p>In this example, we import a static scene, and then randomly sample a pair of locations in the scene and compute the shortest path between them. The code can be found here: <a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/scenes/g_scene_selector.py">igibson/examples/scenes/g_scene_selector.py</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">platform</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">igibson.render.mesh_renderer.mesh_renderer_settings</span> <span class="kn">import</span> <span class="n">MeshRendererSettings</span>
<span class="kn">from</span> <span class="nn">igibson.render.profiler</span> <span class="kn">import</span> <span class="n">Profiler</span>
<span class="kn">from</span> <span class="nn">igibson.scenes.gibson_indoor_scene</span> <span class="kn">import</span> <span class="n">StaticIndoorScene</span>
<span class="kn">from</span> <span class="nn">igibson.simulator</span> <span class="kn">import</span> <span class="n">Simulator</span>
<span class="kn">from</span> <span class="nn">igibson.utils.assets_utils</span> <span class="kn">import</span> <span class="n">get_available_g_scenes</span>
<span class="kn">from</span> <span class="nn">igibson.utils.utils</span> <span class="kn">import</span> <span class="n">let_user_pick</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">selection</span><span class="o">=</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="n">headless</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">short_exec</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prompts the user to select any available non-interactive scene and loads it.</span>
<span class="sd">    Shows how to load directly scenes without the Environment interface</span>
<span class="sd">    Shows how to sample points in the scene and how to compute geodesic distance and the shortest path</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Description:&quot;</span> <span class="o">+</span> <span class="n">main</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">+</span> <span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
    <span class="n">available_g_scenes</span> <span class="o">=</span> <span class="n">get_first_options</span><span class="p">()</span>
    <span class="n">scene_id</span> <span class="o">=</span> <span class="n">available_g_scenes</span><span class="p">[</span><span class="n">let_user_pick</span><span class="p">(</span><span class="n">available_g_scenes</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">selection</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="n">MeshRendererSettings</span><span class="p">(</span><span class="n">enable_shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">msaa</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Reduce texture scale for Mac.</span>
    <span class="k">if</span> <span class="n">platform</span> <span class="o">==</span> <span class="s2">&quot;darwin&quot;</span><span class="p">:</span>
        <span class="n">settings</span><span class="o">.</span><span class="n">texture_scale</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;gui_interactive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">headless</span> <span class="k">else</span> <span class="s2">&quot;headless&quot;</span><span class="p">,</span>
        <span class="n">image_width</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
        <span class="n">image_height</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
        <span class="n">rendering_settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">scene</span> <span class="o">=</span> <span class="n">StaticIndoorScene</span><span class="p">(</span>
        <span class="n">scene_id</span><span class="p">,</span>
        <span class="n">build_graph</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">import_scene</span><span class="p">(</span><span class="n">scene</span><span class="p">)</span>

    <span class="c1"># Shows how to sample points in the scene</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">random_floor</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">get_random_floor</span><span class="p">()</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">get_random_point</span><span class="p">(</span><span class="n">random_floor</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">get_random_point</span><span class="p">(</span><span class="n">random_floor</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">shortest_path</span><span class="p">,</span> <span class="n">geodesic_distance</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">get_shortest_path</span><span class="p">(</span><span class="n">random_floor</span><span class="p">,</span> <span class="n">p1</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">p2</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">entire_path</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Random point 1: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p1</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Random point 2: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p2</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Geodesic distance between p1 and p2: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">geodesic_distance</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shortest path from p1 to p2: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">shortest_path</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">headless</span><span class="p">:</span>
        <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Press enter&quot;</span><span class="p">)</span>

    <span class="n">max_steps</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">short_exec</span> <span class="k">else</span> <span class="mi">1000</span>
    <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">step</span> <span class="o">!=</span> <span class="n">max_steps</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">Profiler</span><span class="p">(</span><span class="s2">&quot;Simulator step&quot;</span><span class="p">):</span>
            <span class="n">s</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="n">step</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">s</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">get_first_options</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">get_available_g_scenes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="interactive-building-scenes">
<h3>Interactive Building Scenes<a class="headerlink" href="#interactive-building-scenes" title="Permalink to this headline"></a></h3>
<p>In this example, we import a fully interactive scene, and randomly sample points given a room type such as “living_room”. This can be useful for tasks that require the robot to always be spawned in certain room types. We support fifteen such scenes right now as part of the new iGibson Dataset. The code can be found here: <a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/scenes/ig_scene_selector.py">igibson/examples/scenes/ig_scene_selector.py</a>.</p>
<p>Note that all objects in these scenes can be interacted realistically.
<img alt="scene_interactive.png" src="_images/scene_interactive.png" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">platform</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">igibson.render.mesh_renderer.mesh_renderer_settings</span> <span class="kn">import</span> <span class="n">MeshRendererSettings</span>
<span class="kn">from</span> <span class="nn">igibson.render.profiler</span> <span class="kn">import</span> <span class="n">Profiler</span>
<span class="kn">from</span> <span class="nn">igibson.scenes.igibson_indoor_scene</span> <span class="kn">import</span> <span class="n">InteractiveIndoorScene</span>
<span class="kn">from</span> <span class="nn">igibson.simulator</span> <span class="kn">import</span> <span class="n">Simulator</span>
<span class="kn">from</span> <span class="nn">igibson.utils.assets_utils</span> <span class="kn">import</span> <span class="n">get_available_ig_scenes</span>
<span class="kn">from</span> <span class="nn">igibson.utils.utils</span> <span class="kn">import</span> <span class="n">let_user_pick</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">selection</span><span class="o">=</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="n">headless</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">short_exec</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prompts the user to select any available interactive scene and loads it.</span>
<span class="sd">    Shows how to load directly scenes without the Environment interface</span>
<span class="sd">    Shows how to sample points in the scene by room type and how to compute geodesic distance and the shortest path</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Description:&quot;</span> <span class="o">+</span> <span class="n">main</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">+</span> <span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
    <span class="n">available_ig_scenes</span> <span class="o">=</span> <span class="n">get_first_options</span><span class="p">()</span>
    <span class="n">scene_id</span> <span class="o">=</span> <span class="n">available_ig_scenes</span><span class="p">[</span><span class="n">let_user_pick</span><span class="p">(</span><span class="n">available_ig_scenes</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">selection</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="n">MeshRendererSettings</span><span class="p">(</span><span class="n">enable_shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">msaa</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">platform</span> <span class="o">==</span> <span class="s2">&quot;darwin&quot;</span><span class="p">:</span>
        <span class="n">settings</span><span class="o">.</span><span class="n">texture_scale</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;gui_interactive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">headless</span> <span class="k">else</span> <span class="s2">&quot;headless&quot;</span><span class="p">,</span>
        <span class="n">image_width</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
        <span class="n">image_height</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
        <span class="n">rendering_settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">scene</span> <span class="o">=</span> <span class="n">InteractiveIndoorScene</span><span class="p">(</span>
        <span class="n">scene_id</span><span class="p">,</span>
        <span class="c1"># load_object_categories=[],  # To load only the building. Fast</span>
        <span class="n">build_graph</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">import_scene</span><span class="p">(</span><span class="n">scene</span><span class="p">)</span>

    <span class="c1"># Shows how to sample points in the scene</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">get_random_point_by_room_type</span><span class="p">(</span><span class="s2">&quot;living_room&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Random point in living_room: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pt</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">random_floor</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">get_random_floor</span><span class="p">()</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">get_random_point</span><span class="p">(</span><span class="n">random_floor</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">get_random_point</span><span class="p">(</span><span class="n">random_floor</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">shortest_path</span><span class="p">,</span> <span class="n">geodesic_distance</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">get_shortest_path</span><span class="p">(</span><span class="n">random_floor</span><span class="p">,</span> <span class="n">p1</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">p2</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">entire_path</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Random point 1: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p1</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Random point 2: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p2</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Geodesic distance between p1 and p2: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">geodesic_distance</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shortest path from p1 to p2: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">shortest_path</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">headless</span><span class="p">:</span>
        <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Press enter&quot;</span><span class="p">)</span>

    <span class="n">max_steps</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">short_exec</span> <span class="k">else</span> <span class="mi">1000</span>
    <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">step</span> <span class="o">!=</span> <span class="n">max_steps</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">Profiler</span><span class="p">(</span><span class="s2">&quot;Simulator step&quot;</span><span class="p">):</span>
            <span class="n">s</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="n">step</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">s</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">get_first_options</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">get_available_ig_scenes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="texture-randomization">
<h4>Texture Randomization<a class="headerlink" href="#texture-randomization" title="Permalink to this headline"></a></h4>
<p>In this example, we demonstrate material/texture randomization functionality of <code class="docutils literal notranslate"><span class="pre">InteractiveIndoorScene</span></code>. The goal is to randomize the material, texture and dynamic properties of all scene objects by calling <code class="docutils literal notranslate"><span class="pre">scene.randomize_texture</span></code> on-demand. The code can be found here: <a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/scenes/scene_texture_rand_example.py">igibson/examples/scenes/scene_texture_rand_example.py</a>.</p>
<p>The randomized materials in the <code class="docutils literal notranslate"><span class="pre">ExternalView</span></code> window should look like this.
<img alt="scene_interactive_texture_rand" src="_images/scene_interactive_texture_rand.png" /></p>
</div>
<div class="section" id="object-randomization">
<h4>Object Randomization<a class="headerlink" href="#object-randomization" title="Permalink to this headline"></a></h4>
<p>In this example, we demonstrate object randomization functionality of <code class="docutils literal notranslate"><span class="pre">InteractiveIndoorScene</span></code>. The goal is to randomize the object models while maintaining their poses and categories. Note that when object models are randomized, there is no guarantee that they have no collisions or the fixed, articulated objects can extend their joints without collision. We provide <code class="docutils literal notranslate"><span class="pre">scene.check_scene_quality</span></code> functionality to check scene quality and you should do object model re-sampling if this function returns <code class="docutils literal notranslate"><span class="pre">False</span></code>. An alternative way (recommended) is to use randoml object model configuration that we provide (10 for each scenes) which guarantees scene quality, by passing in <code class="docutils literal notranslate"><span class="pre">object_randomization_idx=[0-9]</span></code>. Finally, object randomization can be expensive because the new object models need to be loaded to the simulator each time, so we recommend only using it occasionally (e.g. every 1000 training episodes). The code can be found here: <a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/scenes/scene_texture_rand_example.py">igibson/examples/scenes/scene_texture_rand_example.py</a>.</p>
<p>The randomized object models in the <code class="docutils literal notranslate"><span class="pre">ExternalView</span></code> window should look like this.
<img alt="scene_interactive_object_rand" src="_images/scene_interactive_object_rand.png" /></p>
</div>
<div class="section" id="partial-scene-loading">
<h4>Partial Scene Loading<a class="headerlink" href="#partial-scene-loading" title="Permalink to this headline"></a></h4>
<p>In this example, we demonstrate partial scene loading functionality of <code class="docutils literal notranslate"><span class="pre">InteractiveIndoorScene</span></code>. Specifically in this example we only load “chairs” in “living rooms”. This can be useful for tasks that only require certain object categories or rooms. The code can be found here: <a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/scenes/scene_partial_loading_example.py">igibson/examples/scenes/scene_partial_loading_example.py</a>.</p>
</div>
</div>
<div class="section" id="visualize-traversability-map">
<h3>Visualize Traversability Map<a class="headerlink" href="#visualize-traversability-map" title="Permalink to this headline"></a></h3>
<p>In this example, we visuliaze the traversability map of a scene. We use this map to build an internal traversability graph for each floor so that we can compute the shortest path between two locations, and place robots and objects at valid locations inside the scene. The code can be found here: <a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/robots/trav_map_vis_example.py">igibson/examples/robots/trav_map_vis_example.py</a>.</p>
<p>The traversability map of the scene <code class="docutils literal notranslate"><span class="pre">Rs</span></code> looks like this:
<img alt="trav_map_vis" src="_images/trav_map_vis.png" /></p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="environments.html" class="btn btn-neutral float-left" title="Environments" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="objects.html" class="btn btn-neutral float-right" title="Objects" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Stanford University 2018-2021.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>