<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Objects &mdash; iGibson 2.2.1 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Robots" href="robots.html" />
    <link rel="prev" title="Scenes" href="scenes.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> iGibson
          </a>
              <div class="version">
                2.2.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">iGibson: the Interactive Gibson Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview of Modules</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="assets.html">Assets</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulators.html">Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="extended_states.html">Extended States and Logic States</a></li>
<li class="toctree-l1"><a class="reference internal" href="renderer.html">Renderer</a></li>
<li class="toctree-l1"><a class="reference internal" href="viewer.html">Viewer</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.html">Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="scenes.html">Scenes</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Objects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#behavior-dataset-of-objects">BEHAVIOR Dataset of Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-other-objects-to-igibson">Adding other objects to iGibson</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="robots.html">Robots</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">Sampling Scene Instances</a></li>
<li class="toctree-l1"><a class="reference internal" href="learning_framework.html">Learning Frameworks</a></li>
<li class="toctree-l1"><a class="reference internal" href="ros_integration.html">ROS Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">Tests and Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Code Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="apidoc/modules.html">igibson</a></li>
</ul>
<p class="caption"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="issues.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="projects.html">Projects using Gibson/iGibson</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgments</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">iGibson</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Objects</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/objects.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="objects">
<h1>Objects<a class="headerlink" href="#objects" title="Permalink to this headline"></a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p>We provide a wide variety of <strong>Objects</strong> that can be imported into the <strong>Simulator</strong>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">YCBObject</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RBOObject</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ShapeNetObject</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Pedestrian</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ArticulatedObject</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">URDFObject</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SoftObject</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Cube</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VisualMarker</span></code></p></li>
</ul>
<p>Typically, they take in the name or the path of an object (in <code class="docutils literal notranslate"><span class="pre">igibson.assets_path</span></code>) and provide a <code class="docutils literal notranslate"><span class="pre">load</span></code> function that be invoked externally (usually by <code class="docutils literal notranslate"><span class="pre">import_object</span></code> and <code class="docutils literal notranslate"><span class="pre">import_object</span></code> of <code class="docutils literal notranslate"><span class="pre">Simulator</span></code>). The <code class="docutils literal notranslate"><span class="pre">load</span></code> function imports the object into PyBullet. Some <strong>Objects</strong> (e.g. <code class="docutils literal notranslate"><span class="pre">ArticulatedObject</span></code>) also provide APIs to get and set the object pose.</p>
<p>Most of the code can be found here: <a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/objects">igibson/objects</a>.</p>
</div>
<div class="section" id="behavior-dataset-of-objects">
<h2>BEHAVIOR Dataset of Objects<a class="headerlink" href="#behavior-dataset-of-objects" title="Permalink to this headline"></a></h2>
<p>We use a new dataset of everyday objects, the BEHAVIOR Dataset of Objects. In total, we curate 1217 object models across 391 object categories, to support 100 BEHAVIOR activities. The categories range from food items to tableware, from home decorations to office supplies, and from apparel to cleaning tools.</p>
<p>To maintain high visual realism, all object models include material information (metallic, roughness) that can be rendered by iGibson 2.0 renderer. To maintain high physics realism, object models are annotated with size, mass, center of mass, moment of inertia, and also stable orientations. The collision mesh is a simplified version of the visual mesh, obtained with a convex decomposition using the VHACD algorithm. Object models with a shape close to a box are annotated with a primitive box collision mesh, much more efficient and robust for collision checking.</p>
<p>All models in the BEHAVIOR Dataset are organized following the WordNet, associating them to synsets. This structure allows us to define properties for all models of the same categories, but it also facilitates more general sampling of activity instances fulfilling initial conditions such as onTop(fruit, table) that can be achieved using any model within the branch fruit of WordNet.</p>
<p>Please see below for an updated file structure for BEHAVIOR Dataset</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>OBJECT_NAME
│   <span class="c1"># Unified Robot Description Format (URDF)</span>
│   <span class="c1"># http://wiki.ros.org/urdf</span>
│   <span class="c1"># It defines the object model (parts, articulation, dynamics properties etc.).</span>
│   OBJECT_NAME.urdf 
│
└───shape
│   └───visual 
│   │    │   <span class="c1"># Directory containing visual meshes (vm) of the object. Used for iGibson&#39;s rendering. Encrypted</span>
│   │    │   <span class="c1"># All objs are UV mapped onto the same texture, linked by default.mtl. All faces are triangles.</span>
│   │    │  vm1.encrypted.obj
│   │    │  vm2.encrypted.obj
│   │    │  …
│   │    │  default.mtl <span class="o">(</span>links the geometry to the texture files<span class="o">)</span>
│   │ 
│   └───collision
│   │    │   <span class="c1"># Directory containing collision meshes (cm) of the objects. Used for iGibson&#39;s physics simulation.</span>
│   │    │   <span class="c1"># Each obj represents a unique link of the object.</span>
│   │    │   <span class="c1"># For example, link_1_cm.obj represents the collision mesh of link_1. </span>
│   │    │  cm1.obj
│   │    │  cm2.obj
│   │    │  …
│
└───material
│   │   <span class="c1"># Contains 4 default channels:</span>
│   │   <span class="c1"># 	DIFFUSE.png (RGB albedo map)</span>
│   │   <span class="c1"># 	METALLIC.png (metallic map)</span>
│   │   <span class="c1"># 	NORMAL.png (tangent normal map)</span>
│   │   <span class="c1"># 	ROUGHNESS.png (roughness map)</span>
<span class="p">|</span>   <span class="p">|</span>   <span class="c1"># Also contains diffuse texture maps that will be used when some object state changes happen, e.g. cooked, burnt, or soaked.</span>
│   │   DIFFUSE.encrypted.png
│   │   METALLIC.encrypted.png	
│   │   NORMAL.encrypted.png
│   │   ROUGHNESS.encrypted.png
│   │   DIFFUSE_Frozen.encrypted.png
│   │   DIFFUSE_Cooked.encrypted.png
│   │   DIFFUSE_Burnt.encrypted.png
│   │   DIFFUSE_Soaked.encrypted.png
│   │   DIFFUSE_ToggledOn.encrypted.png
│
└───misc
│   │   <span class="c1"># contains bounding box information of the object, its stable orientations, object state-related link annotation (e.g. toggle button, water/heat/cold source, slicer/cleaning_tool, etc)</span>
│   │   metadata.json
│   │   <span class="c1"># contains the object’s material annotation of what kinds of material each link can have.</span>
│   │   material_groups.json 
│   │   <span class="c1"># contains info about the minimum volume oriented bounding box that best fits the object</span>
│   │   mvbb_meta.json 
│
└───visualizations
│   │   <span class="c1"># An image and a video of the object rendered with iG renderer</span>
│   │   <span class="m">00</span>.png
│   │   OBJECT_NAME.mp4
</pre></div>
</div>
</div>
<div class="section" id="adding-other-objects-to-igibson">
<h2>Adding other objects to iGibson<a class="headerlink" href="#adding-other-objects-to-igibson" title="Permalink to this headline"></a></h2>
<p>We provide detailed instructions and scripts to import your own objects (non-articulated) into iGibson.</p>
<p>Instruction can be found here: <a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/utils/data_utils/ext_object">External Objects</a>.</p>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline"></a></h2>
<p>In this example, we import a few objects into iGibson. The code can be found here: <a class="reference external" href="https://github.com/StanfordVL/iGibson/blob/master/igibson/examples/objects/load_objects.py">igibson/examples/objects/load_objects.py</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">platform</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">yaml</span>

<span class="kn">import</span> <span class="nn">igibson</span>
<span class="kn">from</span> <span class="nn">igibson.envs.igibson_env</span> <span class="kn">import</span> <span class="n">iGibsonEnv</span>
<span class="kn">from</span> <span class="nn">igibson.external.pybullet_tools.utils</span> <span class="kn">import</span> <span class="n">quat_from_euler</span>
<span class="kn">from</span> <span class="nn">igibson.objects.articulated_object</span> <span class="kn">import</span> <span class="n">URDFObject</span>
<span class="kn">from</span> <span class="nn">igibson.objects.ycb_object</span> <span class="kn">import</span> <span class="n">YCBObject</span>
<span class="kn">from</span> <span class="nn">igibson.render.mesh_renderer.mesh_renderer_cpu</span> <span class="kn">import</span> <span class="n">MeshRendererSettings</span>
<span class="kn">from</span> <span class="nn">igibson.render.profiler</span> <span class="kn">import</span> <span class="n">Profiler</span>
<span class="kn">from</span> <span class="nn">igibson.robots.turtlebot</span> <span class="kn">import</span> <span class="n">Turtlebot</span>
<span class="kn">from</span> <span class="nn">igibson.scenes.empty_scene</span> <span class="kn">import</span> <span class="n">EmptyScene</span>
<span class="kn">from</span> <span class="nn">igibson.scenes.gibson_indoor_scene</span> <span class="kn">import</span> <span class="n">StaticIndoorScene</span>
<span class="kn">from</span> <span class="nn">igibson.simulator</span> <span class="kn">import</span> <span class="n">Simulator</span>
<span class="kn">from</span> <span class="nn">igibson.utils.assets_utils</span> <span class="kn">import</span> <span class="n">get_ig_avg_category_specs</span><span class="p">,</span> <span class="n">get_ig_category_path</span><span class="p">,</span> <span class="n">get_ig_model_path</span>
<span class="kn">from</span> <span class="nn">igibson.utils.utils</span> <span class="kn">import</span> <span class="n">let_user_pick</span><span class="p">,</span> <span class="n">parse_config</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">selection</span><span class="o">=</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="n">headless</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">short_exec</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This demo shows how to load scaled objects from the iG object model dataset and</span>
<span class="sd">    additional objects from the YCB dataset in predefined locations</span>
<span class="sd">    Loads a concrete object model of a table, and a random one of the same category, and 10 cracker boxes</span>
<span class="sd">    The objects can be loaded into an empty scene, an interactive scene (iG) or a static scene (Gibson)</span>
<span class="sd">    The example also shows how to use the Environment API or directly the Simulator API, loading objects and robots</span>
<span class="sd">    and executing actions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Description:&quot;</span> <span class="o">+</span> <span class="n">main</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">+</span> <span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
    <span class="n">scene_options</span> <span class="o">=</span> <span class="n">get_first_options</span><span class="p">()</span>
    <span class="n">type_of_scene</span> <span class="o">=</span> <span class="n">let_user_pick</span><span class="p">(</span><span class="n">scene_options</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">selection</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">type_of_scene</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Empty</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">parse_config</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">igibson</span><span class="o">.</span><span class="n">configs_path</span><span class="p">,</span> <span class="s2">&quot;turtlebot_static_nav.yaml&quot;</span><span class="p">))</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="n">MeshRendererSettings</span><span class="p">(</span><span class="n">enable_shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">msaa</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">texture_scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;gui_interactive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">headless</span> <span class="k">else</span> <span class="s2">&quot;headless&quot;</span><span class="p">,</span>
            <span class="n">image_width</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
            <span class="n">image_height</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
            <span class="n">rendering_settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">scene</span> <span class="o">=</span> <span class="n">EmptyScene</span><span class="p">(</span><span class="n">floor_plane_rgba</span><span class="o">=</span><span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="c1"># scene.load_object_categories(benchmark_names)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">import_scene</span><span class="p">(</span><span class="n">scene</span><span class="p">)</span>
        <span class="n">robot_config</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;robot&quot;</span><span class="p">]</span>
        <span class="n">robot_config</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
        <span class="n">turtlebot</span> <span class="o">=</span> <span class="n">Turtlebot</span><span class="p">(</span><span class="o">**</span><span class="n">robot_config</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">import_object</span><span class="p">(</span><span class="n">turtlebot</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">type_of_scene</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># iG</span>
        <span class="n">config_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">igibson</span><span class="o">.</span><span class="n">configs_path</span><span class="p">,</span> <span class="s2">&quot;turtlebot_nav.yaml&quot;</span><span class="p">)</span>
        <span class="n">config_data</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">config_filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">),</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span>
        <span class="n">config_data</span><span class="p">[</span><span class="s2">&quot;load_object_categories&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Uncomment this line to accelerate loading with only the building</span>
        <span class="n">config_data</span><span class="p">[</span><span class="s2">&quot;visible_target&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">config_data</span><span class="p">[</span><span class="s2">&quot;visible_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Reduce texture scale for Mac.</span>
        <span class="k">if</span> <span class="n">platform</span> <span class="o">==</span> <span class="s2">&quot;darwin&quot;</span><span class="p">:</span>
            <span class="n">config_data</span><span class="p">[</span><span class="s2">&quot;texture_scale&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">env</span> <span class="o">=</span> <span class="n">iGibsonEnv</span><span class="p">(</span><span class="n">config_file</span><span class="o">=</span><span class="n">config_data</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;gui_interactive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">headless</span> <span class="k">else</span> <span class="s2">&quot;headless&quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">simulator</span>

    <span class="k">elif</span> <span class="n">type_of_scene</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Gibson</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">parse_config</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">igibson</span><span class="o">.</span><span class="n">configs_path</span><span class="p">,</span> <span class="s2">&quot;turtlebot_static_nav.yaml&quot;</span><span class="p">))</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="n">MeshRendererSettings</span><span class="p">(</span><span class="n">enable_shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">msaa</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Reduce texture scale for Mac.</span>
        <span class="k">if</span> <span class="n">platform</span> <span class="o">==</span> <span class="s2">&quot;darwin&quot;</span><span class="p">:</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">texture_scale</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;gui_interactive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">headless</span> <span class="k">else</span> <span class="s2">&quot;headless&quot;</span><span class="p">,</span>
            <span class="n">image_width</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
            <span class="n">image_height</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
            <span class="n">rendering_settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">scene</span> <span class="o">=</span> <span class="n">StaticIndoorScene</span><span class="p">(</span><span class="s2">&quot;Rs&quot;</span><span class="p">,</span> <span class="n">build_graph</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pybullet_load_texture</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">import_scene</span><span class="p">(</span><span class="n">scene</span><span class="p">)</span>
        <span class="n">robot_config</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;robot&quot;</span><span class="p">]</span>
        <span class="n">robot_config</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
        <span class="n">turtlebot</span> <span class="o">=</span> <span class="n">Turtlebot</span><span class="p">(</span><span class="o">**</span><span class="n">robot_config</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">import_object</span><span class="p">(</span><span class="n">turtlebot</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">headless</span><span class="p">:</span>
        <span class="c1"># Set a better viewing direction</span>
        <span class="n">s</span><span class="o">.</span><span class="n">viewer</span><span class="o">.</span><span class="n">initial_pos</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]</span>
        <span class="n">s</span><span class="o">.</span><span class="n">viewer</span><span class="o">.</span><span class="n">initial_view_direction</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
        <span class="n">s</span><span class="o">.</span><span class="n">viewer</span><span class="o">.</span><span class="n">reset_viewer</span><span class="p">()</span>

    <span class="c1"># Objects to load: two tables, the first one is predefined model, the second, random for the same category</span>
    <span class="n">table_objects_to_load</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;table_1&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;breakfast_table&quot;</span><span class="p">,</span>
            <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="s2">&quot;1b4e6f9dd22a8c628ef9d976af675b86&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pos&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">),</span>
            <span class="s2">&quot;orn&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span>
        <span class="p">},</span>
        <span class="s2">&quot;table_2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;breakfast_table&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pos&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">),</span>
            <span class="s2">&quot;orn&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span>
        <span class="p">},</span>
    <span class="p">}</span>

    <span class="c1"># Load the specs of the object categories, e.g., common scaling factor</span>
    <span class="n">avg_category_spec</span> <span class="o">=</span> <span class="n">get_ig_avg_category_specs</span><span class="p">()</span>

    <span class="n">scene_objects</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">table_objects_to_load</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">category</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">scene_objects</span><span class="p">:</span>
                <span class="n">scene_objects</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">scene_objects</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="c1"># Get the path for all models of this category</span>
            <span class="n">category_path</span> <span class="o">=</span> <span class="n">get_ig_category_path</span><span class="p">(</span><span class="n">category</span><span class="p">)</span>

            <span class="c1"># If the specific model is given, we use it. If not, we select one randomly</span>
            <span class="k">if</span> <span class="s2">&quot;model&quot;</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                <span class="n">model</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">model</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">category_path</span><span class="p">))</span>

            <span class="c1"># Create the full path combining the path for all models and the name of the model</span>
            <span class="n">model_path</span> <span class="o">=</span> <span class="n">get_ig_model_path</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model_path</span><span class="p">,</span> <span class="n">model</span> <span class="o">+</span> <span class="s2">&quot;.urdf&quot;</span><span class="p">)</span>

            <span class="c1"># Create a unique name for the object instance</span>
            <span class="n">obj_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">scene_objects</span><span class="p">[</span><span class="n">category</span><span class="p">])</span>

            <span class="c1"># Create and import the object</span>
            <span class="n">simulator_obj</span> <span class="o">=</span> <span class="n">URDFObject</span><span class="p">(</span>
                <span class="n">filename</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">obj_name</span><span class="p">,</span>
                <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
                <span class="n">model_path</span><span class="o">=</span><span class="n">model_path</span><span class="p">,</span>
                <span class="n">avg_obj_dims</span><span class="o">=</span><span class="n">avg_category_spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">category</span><span class="p">),</span>
                <span class="n">fit_avg_dim_volume</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">texture_randomization</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">overwrite_inertial</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">s</span><span class="o">.</span><span class="n">import_object</span><span class="p">(</span><span class="n">simulator_obj</span><span class="p">)</span>
            <span class="n">simulator_obj</span><span class="o">.</span><span class="n">set_position_orientation</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;pos&quot;</span><span class="p">],</span> <span class="n">quat_from_euler</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;orn&quot;</span><span class="p">]))</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">YCBObject</span><span class="p">(</span><span class="s2">&quot;003_cracker_box&quot;</span><span class="p">)</span>
            <span class="n">s</span><span class="o">.</span><span class="n">import_object</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">set_position_orientation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mf">1.8</span><span class="p">]),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">type_of_scene</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">max_iterations</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">short_exec</span> <span class="k">else</span> <span class="mi">10</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iterations</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resetting environment&quot;</span><span class="p">)</span>
                <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
                    <span class="k">with</span> <span class="n">Profiler</span><span class="p">(</span><span class="s2">&quot;Environment action step&quot;</span><span class="p">):</span>
                        <span class="c1"># action = env.action_space.sample()</span>
                        <span class="n">state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Episode finished after </span><span class="si">{}</span><span class="s2"> timesteps&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">max_steps</span> <span class="o">=</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">short_exec</span> <span class="k">else</span> <span class="mi">10000</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_steps</span><span class="p">):</span>
                <span class="k">with</span> <span class="n">Profiler</span><span class="p">(</span><span class="s2">&quot;Simulator step&quot;</span><span class="p">):</span>
                    <span class="n">turtlebot</span><span class="o">.</span><span class="n">apply_action</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
                    <span class="n">s</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
                    <span class="n">rgb</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">render_robot_cameras</span><span class="p">(</span><span class="n">modes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;rgb&quot;</span><span class="p">))</span>

    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">type_of_scene</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">get_first_options</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;Empty scene&quot;</span><span class="p">,</span> <span class="s2">&quot;Interactive scene (iG)&quot;</span><span class="p">,</span> <span class="s2">&quot;Static scene (Gibson)&quot;</span><span class="p">]</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="scenes.html" class="btn btn-neutral float-left" title="Scenes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="robots.html" class="btn btn-neutral float-right" title="Robots" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Stanford University 2018-2021.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>